import{r as s,d as f,j as t}from"./index-GfsaLtzC.js";import{g}from"./network-qS66KcGb.js";import{u as m}from"./useQuery-n3eTkuGX.js";import{u as l,P as x}from"./post-listing-HGDNJ4w5.js";import"./utils-g-Ig_Dqa.js";const L=function(){let{isPending:i,error:a,data:r,refetch:n}=m({queryKey:["postData"],queryFn:g});const{connection:e}=l("/r/postHub");s.useEffect(()=>{if(e)return e.on("newpost",()=>{n()}),e.on("updatepost",()=>{n()}),e.on("deletepost",()=>{n()}),()=>{e.off("newpost")}},[e]);const{isAuthenticated:o,isLoading:c,login:u}=f();return s.useEffect(()=>{o&&n()},[o]),c?t.jsx("p",{children:"Loading"}):i?t.jsx("div",{children:"Loading..."}):a?t.jsx("div",{children:"Something went wrong"}):(r=r.sort((d,p)=>new Date(p.createdAt)-new Date(d.createdAt)),t.jsx(t.Fragment,{children:o?t.jsx(x,{posts:r}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Please sign in or register!"}),t.jsx("button",{onClick:()=>u(),type:"button",children:"Sign In"})]})}))};export{L as component};
